<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title></title>
    <link rel="stylesheet" type="text/css" href="../../Scripts/jquery-easyui/themes/default/easyui.css" />
    <link rel="stylesheet" type="text/css" href="../../Scripts/jquery-easyui/themes/icon.css" />
    <script type="text/javascript" src="../../Scripts/jquery-easyui/jquery.min.js"></script>
    <script type="text/javascript" src="../../Scripts/jquery-easyui/jquery.easyui.min.js"></script>
    <script src="../../Scripts/jquery-easyui/locale/easyui-lang-zh_CN.js" type="text/javascript"></script>
    <script src="../../Scripts/json2.js" type="text/javascript"></script>
    <script src="../../Scripts/jquery.cookie.js" type="text/javascript"></script>
    <script src="../../Scripts/global.js" type="text/javascript"></script>
    <script src="../../Scripts/common.js" type="text/javascript"></script>
</head>
<body>
<script type="text/javascript">
    var LocalID = $.cookie("LocalID");
    var datagrid;
    var dd;
    var jsondata = { "total": 0, "rows": [] };
    $(function () {
        datagrid = $("#dg").datagrid({
            idField: "",
            fitColumns: true,
            striped: true,
            title: "用户卡类型",
            collapsible: true,
            remotesort: false,
            rownumbers: true,
            singleSelect: true,
            columns: [[{
                field: 'card_kind',
                title: '用户卡类型',
                //                sortable: true,
                width: "50%"
            }]],
            toolbar: [{
                text: "修改", iconCls: "icon-edit", handler: function () {
                    var rows = datagrid.datagrid('getSelected');
                    if (rows == null) {
                        $.messager.alert("提示", "未选择项", "error");
                        return;
                    }
                    $('#win').window('open');
                    $('#card_kind').val(rows.card_kind);
                    $('#meal_money').val(rows.meal_money);
                    $('#day_money').val(rows.day_money);
                    $('#sh_flag').combobox(rows.sh_flag);
                    $('#kt_flag').combobox(rows.kt_flag);
                    $('#display_flag').combobox(rows.display_flag);
                    dd = 1;

                }
            }]
        });
        loaddata();
        $('#win').window('close');
        $("#close").click(function () {
            $('#win').window('close');
        });
        $("#save").click(function () {

            if (dd == 1) {
                var rows = datagrid.datagrid('getSelected');
                var id = rows.id;
                var card_kind = $('#card_kind').val(rows.card_kind);
                var meal_money = $('#meal_money').val(rows.meal_money);
                var day_money = $('#day_money').val(rows.day_money);
                var sh_flag = $('#sh_flag').combobox(rows.sh_flag);
                var kt_flag = $('#kt_flag').combobox(rows.kt_flag);
                var display_flag = $('#display_flag').combobox(rows.display_flag);
                if (card_kind == "") {
                    alert("用户卡类型不能为空");
                    return;
                }

                Ajax(true, global.xf["UpdateXFMngCardkind"], { LoginID: LocalID, card_kind: card_kind, meal_money: meal_money, day_money: day_money, sh_flag: sh_flag, kt_flag: kt_flag, display_flag: display_flag, id: id }, function (data) {
                    if (!data.Success) {
                        alert(data.Message);
                        return;
                    }
                    $.messager.alert("提示", "添加成功", "info");
                    $('#win').window('close');
                    loaddata();
                });
            }
        });
    });
    function loaddata() {
        datagrid.datagrid('unselectAll');
        Ajax(true, global.xf["GetXFMngCardkindList"], { LoginID: LocalID }, function (data) {
            if (!data.Success) {
                alert(data.Message);
                return;
            }
            jsondata.rows = data.Data;
            datagrid.datagrid('loadData', jsondata);
        });
    }
    </script>
    <div class="easyui-layout">
        <div data-options="region:'left',split:true,collapsible:false" style="width: 100%;">
            <table id="dg" >
            </table>
        </div>
    </div>

    <!--<div id="win" class="easyui-window" title="用户卡类型" data-options="iconCls:'icon-save',minimizable:false,maximizable:false"
        style="width: 250px; height: 200px; padding: 5px;">
        <div class="easyui-layout" data-options="fit:true">
            <div data-options="region:'center'" style="padding: 5px;">
                <table cellpadding="5">
                    <tr>
                        <td>
                            用户卡类型：
                        </td>
                        <td align="left">
                            <input id="name" class="easyui-textbox" style="width: 100px"  />
                        </td>
                    </tr>
                    <tr>
                        <td>
                            一餐限额：
                        </td>
                        <td align="left">
                            <input id="login_id" class="easyui-textbox" style="width: 100px"  />
                        </td>
                    </tr>
                    <tr>
                        <td>
                            一天限额：
                        </td>
                        <td align="left">
                            <input id="psw" class="easyui-textbox" type="password" style="width: 100px"  />
                        </td>
                    </tr>
                </table>
            </div>
            <div data-options="region:'south',border:false" style="text-align: right; padding: 5px 0 0;">
                <a class="easyui-linkbutton" data-options="iconCls:'icon-cancel'" href="javascript:void(0)"
                    id="close" style="width: 80px">关闭</a> <a class="easyui-linkbutton" data-options="iconCls:'icon-ok'"
                        href="javascript:void(0)" id="save" style="width: 80px">提交</a>
            </div>
        </div>
    </div>-->
</body>
</html>
