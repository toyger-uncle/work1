<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <link rel="stylesheet" type="text/css" href="../../Scripts/jquery-easyui/themes/default/easyui.css"/>
	<link rel="stylesheet" type="text/css" href="../../Scripts/jquery-easyui/themes/icon.css" />
	<script type="text/javascript" src="../../Scripts/jquery-easyui/jquery.min.js"></script>
	<script type="text/javascript" src="../../Scripts/jquery-easyui/jquery.easyui.min.js"></script>
    <script src="../../Scripts/jquery-easyui/locale/easyui-lang-zh_CN.js" type="text/javascript"></script>
    <script src="../../Scripts/json2.js" type="text/javascript"></script>
    <script src="../../Scripts/jquery.cookie.js" type="text/javascript"></script>
    <script src="../../Scripts/constant.js" type="text/javascript"></script>
    <script src="../../Scripts/common.js" type="text/javascript"></script>	
</head>
<body>
    <script type="text/javascript">
        var LocalID = $.cookie("LocalID");
        var ztt;
        $(function () {
            Ajax(true, mj["GetMJControlDoorList"], { LoginID: LocalID }, function (data) {
                if (!data.Success) {
                    alert(data.Message);
                    return;
                }
                $('#kai1').combobox({
                    data: data.Data,
                    valueField: 'id',
                    textField: 'door_name'
                });
            });
            $("#zk").click(function () {
                var time1 = $("#text").val();
                var name1 = $("#kai1").combobox('getValue');
                ztt = 1;
                if (name1 == "") {
                    $.messager.alert("提示", "未选择门", "error");
                    return;
                }
                Ajax(true, mj["RemoteDoor"], { LoginID: LocalID, door_id: name1, openOrClose: ztt, time: time1 }, function (data) {
                    if (!data.Success) {
                        alert(data.Message);
                        return;
                    }
                    var ab = data.Data;
                    if (ab == true) {
                        $.messager.alert("提示", "开门成功", "info");
                    }
                    else { $.messager.alert("提示", "开门失败", "error"); }
                });
            });
            $("#yk").click(function () {
                var time1 = 0;
                var name1 = $("#kai1").combobox('getValue');
                ztt = 1;
                if (name1 == "") {
                    $.messager.alert("提示", "未选择门", "error");
                    return;
                }
                Ajax(true, mj["RemoteDoor"], { LoginID: LocalID, door_id: name1, openOrClose: ztt, time: time1 }, function (data) {
                    if (!data.Success) {
                        alert(data.Message);
                        return;
                    }
                    var ab = data.Data;
                    if (ab == true) {
                        $.messager.alert("提示", "开门成功", "info");
                    }
                    else { $.messager.alert("提示", "开门失败", "error"); }
                });
            });
            $("#yg").click(function () {
                var time1 = 0;
                var name1 = $("#kai1").combobox('getValue');
                ztt = 0;
                if (name1 == "") {
                    $.messager.alert("提示", "未选择门", "error");
                    return;
                }
                Ajax(true, mj["RemoteDoor"], { LoginID: LocalID, door_id: name1, openOrClose: ztt, time: time1 }, function (data) {
                    if (!data.Success) {
                        alert(data.Message);
                        return;
                    }
                    var ab = data.Data;
                    if (ab == true) {
                        $.messager.alert("提示", "关门成功", "info");
                    }
                    if (ab == false) { $.messager.alert("提示", "关门失败", "error"); }
                });
            });
            $("#hui1").click(function () {
                var name1 = $("#kai1").combobox('getValue');
                if (name1 == "") {
                    $.messager.alert("提示", "未选择门", "error");
                    return;
                }
                Ajax(true, mj["GetMJControlDoor"], { LoginID: LocalID, id: name1 }, function (data) {
                if (!data.Success) {
                    alert(data.Message);
                    return;
                }
                var mach = data.Data.control_id;
                Ajax(true, mj["MachReset"], { LoginID: LocalID, mach_id: mach }, function (data) {
                    if (!data.Success) {
                        alert(data.Message);
                        return;
                    }
                    if (data.Data == true) {
                        $.messager.alert("提示", "发送成功", "info");
                    }
                    else { $.messager.alert("提示", "发送失败", "error"); }
                });
            });
            });
        });
</script>
<div class="easyui-panel" title="单门控制" data-options="collapsible:true,maximized:true" style="width:100%;height:500px; padding:2px;">
	<div class="easyui-layout" data-options="fit:true">
		<div data-options="region:'north',collapsible:false" style="width:100%;height:35px;">
  	        <a class="easyui-linkbutton" data-options="" href="javascript:void(0)" id="zk" style="width:80px">暂时开门</a>
            <a class="easyui-linkbutton" data-options="" href="javascript:void(0)" id="yk" style="width:80px">永远开门</a>
            <a class="easyui-linkbutton" data-options="" href="javascript:void(0)" id="yg" style="width:80px">永远关闭</a>
            <a class="easyui-linkbutton" data-options="" href="javascript:void(0)" id="hui1" style="width:80px">恢复自控</a>
  </div>
		<div data-options="region:'west',collapsible:false" >
		 门区：<select id="kai1" class="easyui-combobox" style="width:150px;height:20px"></select>
         时间：<input id="text" class="easyui-validatebox textbox" value ="5"style="width:20px"" />s
		</div>
		
	</div>
 </div>
</body>
</html>
